(this.webpackJsonpthree=this.webpackJsonpthree||[]).push([[0],{42:function(e,t,n){e.exports=n(55)},50:function(e,t,n){},51:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(17),o=n.n(r),s=n(20),c=(n(50),n(5)),l=(n(51),{left:[[-400,-1050],[400,-1050],[400,1050],[-400,1050]],leftHoles:[[[-35,800],[-35,750],[35,750],[35,800]]],door:[[-350,-895],[350,-895],[350,900],[-350,900]],transom:[[-350,900],[350,900],[350,1195],[-350,1195]],right:[[-300,-1050],[-3,-1050],[-3,-755],[0,-750],[5,-747],[300,-747],[300,1050],[-300,1050]]}),u={left:[],door:[],transom:[],right:[]};function h(e,t){return e.map((function(e){return[e[0],e[1],t]}))}var d={origin:[0,1e3,0],junctionAngles:[0,90,90,0],defaultCamera:{position:[2300,2050,1250],lookAt:[800,2050,0]},ground:{origin:[400,1e3,-350],lengthX:1200,lengthZ:1100},positions:[{position:1,offset:[795,0,-6],children:[{id:"panel/1",origin:[400,1050,0],rotation:[0,0,0],material:"glass",gazeSize:[800,2100,10],uvScale:256,operable:!1,type:"extrusion",frontFace:h(l.left,5),frontFaceHoles:l.leftHoles.map((function(e){return h(e,5)})),backFace:h(l.left,-5),backFaceHoles:l.leftHoles.map((function(e){return h(e,-5)})),smoothVertices:u.left,children:[{id:"feature/1",origin:[373,-550,0],rotation:[0,0,0],material:"metal",gazeSize:[256,512,20],uvScale:16,operable:!1,type:"cuboid",lengthX:64,lengthY:128,lengthZ:20},{id:"feature/2",origin:[373,150,0],rotation:[0,0,0],material:"metal",gazeSize:[256,512,20],uvScale:16,operable:!1,type:"cuboid",lengthX:64,lengthY:128,lengthZ:20},{id:"feature/3",origin:[373,900,0],rotation:[0,0,0],material:"metal",gazeSize:[256,256,20],uvScale:16,operable:!1,type:"cuboid",lengthX:64,lengthY:64,lengthZ:20}]}]},{position:2,offset:[706,0,5],children:[{type:"extrusion",id:"panel/2",frontFace:h(l.door,5),frontFaceHoles:[],backFace:h(l.door,-5),backFaceHoles:[],smoothVertices:u.door,uvScale:256,operable:!0,pivot:[0,0,0],origin:[350,900,0],rotation:[0,0,0],gazeSize:[10,1800,700],material:"glass",children:[{id:"feature/6",origin:[250,100,0],rotation:[0,0,0],material:"metal",gazeSize:[256,1024,48],uvScale:16,operable:!1,type:"pipe",radius:12,points:[[0,-128,0],[0,-128,64],[0,-64,64],[0,0,64],[0,64,64],[0,128,64],[0,128,0]]}]},{type:"extrusion",id:"panel/3",frontFace:h(l.transom,5),frontFaceHoles:[],backFace:h(l.transom,-5),backFaceHoles:[],smoothVertices:u.transom,uvScale:256,operable:!1,origin:[350,905,0],rotation:[0,0,0],gazeSize:[10,300,700],material:"glass",children:[{id:"feature/4",origin:[-314,1045,0],rotation:[0,0,0],material:"metal",gazeSize:[256,256,20],uvScale:16,operable:!1,type:"cuboid",lengthX:64,lengthY:64,lengthZ:20},{id:"feature/5",origin:[314,1045,0],rotation:[0,0,0],material:"metal",gazeSize:[256,256,20],uvScale:16,operable:!1,type:"cuboid",lengthX:64,lengthY:64,lengthZ:20}]}]},{position:3,offset:[600,0,5],children:[{type:"extrusion",id:"panel/4",frontFace:h(l.right,5),frontFaceHoles:[],backFace:h(l.right,-5),backFaceHoles:[],smoothVertices:u.right,uvScale:256,operable:!1,origin:[300,1050,0],rotation:[0,0,0],gazeSize:[600,2100,10],material:"glass",children:[{id:"feature/7",origin:[-273,900,0],rotation:[0,0,0],material:"metal",gazeSize:[256,256,20],uvScale:16,operable:!1,type:"cuboid",lengthX:64,lengthY:64,lengthZ:20}]}]}],measurements:[{id:"measurement/1",length:2100,start:{parentId:"panel/1",origin:[-400,-1050,0]},finish:{parentId:"panel/1",origin:[-400,1050,0]}},{id:"measurement/2",length:800,start:{parentId:"panel/1",origin:[-400,-1050,0]},finish:{parentId:"panel/1",origin:[400,-1050,0]}},{id:"measurement/3",length:700,start:{parentId:"panel/2",origin:[-350,-900,0]},finish:{parentId:"panel/2",origin:[350,-900,0]}}]},f=n(27),m=n(2),g=new Map,p={counter:0,gazeDirection:void 0,gazeTarget:void 0,gazeSize:void 0,selected:"",selectionFilter:"",orthographic:!1,showJunctionAngles:!0,showGround:!1,showHardware:!0,showMeasurements:!1,animateDoors:!1};function b(e,t){return{type:"FOCUS_OBJECT",payload:{id:e,select:t}}}function v(e){return{type:"MODIFY_DISPLAY",payload:e}}function y(e){return[e.x,e.y,e.z]}function w(e,t){var n=t.payload,a=n.id,i=n.select,r=function(e){if(""!==e){var t=g.get(e),n=t.mesh,a=t.gazeSize;if(n){n.updateMatrixWorld();var i=new m.Vector3(0,0,0);n.getWorldDirection(i).multiplyScalar(-1);var r=new m.Box3;r.setFromObject(n);var o=y(i);return r.getCenter(i),[o,y(i),a]}}return[void 0,void 0]}(a),o=Object(c.a)(r,3),s=o[0],l=o[1],u=o[2],h=i?a:e.selected,d=(e.counter+1)%100;return Object(f.a)({},e,{counter:d,gazeDirection:s,gazeTarget:l,gazeSize:u,selected:h})}function O(e,t){return Object(f.a)({},e,{},t.payload)}function S(e,t){return Object(f.a)({},e,{},t.payload)}var j=n(13),E=n(15),F=n(22),k=n(14),C=function(e){var t=e.id,n=e.material,r=e.canSelect,o=e.selected,s=e.onFocusObject,l=e.gazeSize,u=e.operable,h=e.animateDoors,d=e.origin,f=e.pivot,m=e.rotation,p=e.visible,b=e.geometry,v=e.children,y=Object(a.useState)(!1),w=Object(c.a)(y,2),O=w[0],S=w[1],j=Object(a.useCallback)((function(e){e.stopPropagation(),r&&s(o?"":t,!0)}),[r,o,t,s]),C=Object(a.useCallback)((function(e){e.stopPropagation(),r&&!O&&S(!0)}),[r,O,S]),M=Object(a.useCallback)((function(){O&&S(!1)}),[O,S]),T=o?n.selected:O?n.hover:n.standard,z=Object(E.g)((function(e){g.set(t,{mesh:e,gazeSize:l})}),[t,l]);return Object(a.useEffect)((function(){if(z.current&&u&&h){var e=z.current,t={y:e.rotation.y},n=function(){var n=f||[0,0,0],a=Object(c.a)(n,3),i=a[0],r=a[1],o=a[2],s=Object(c.a)(d,3),l=s[0],u=s[1],h=s[2];e.position.set(l-i,u-r,h-o),e.position.applyAxisAngle(e.up,t.y);var m=e.position,g=m.x,p=m.y,b=m.z;e.position.set(g+i,p+r,b+o),e.rotation.y=t.y},a=.45*Math.PI,i=a/2e3,r=k.a.Easing.Quadratic.InOut,o=new k.a.Tween(t).to({y:0},Math.max(.01,Math.abs(t.y)/i)).onUpdate(n),s=new k.a.Tween(t).to({y:a},2e3).easing(r).onUpdate(n),l=new k.a.Tween(t).to({y:0},2e3).easing(r).onUpdate(n),m=new k.a.Tween(t).to({y:-a},2e3).easing(r).onUpdate(n),g=new k.a.Tween(t).to({y:0},2e3).easing(r).onUpdate(n);return o.chain(s),s.chain(l),l.chain(m),m.chain(g),g.chain(s),o.start(),function(){g.stop(),m.stop(),l.stop(),s.stop(),o.stop(),k.a.remove(g),k.a.remove(m),k.a.remove(l),k.a.remove(s),k.a.remove(o)}}}),[z,d,u,h]),i.a.createElement(F.a.mesh,{ref:z,onClick:j,position:d,onPointerOver:C,onPointerOut:M,material:T,rotation:m,visible:p,geometry:b},v)},M=n(4),T=n(9),z=n(7),x=n(8),V=function(e){function t(e){var n;return Object(M.a)(this,t),(n=Object(T.a)(this,Object(z.a)(t).call(this,e.lengthX,e.lengthY,e.lengthZ,1,1,1))).className="CuboidGeometry",n}return Object(x.a)(t,e),t}(m.BoxBufferGeometry),P=function(e){function t(e){Object(M.a)(this,t);var n=e.points,a=e.radius,i=n.map((function(e){return new m.Vector3(e[0],e[1],e[2])}));return Object(T.a)(this,Object(z.a)(t).call(this,new m.CatmullRomCurve3(i,!1),64,a,8,!1))}return Object(x.a)(t,e),t}(m.TubeBufferGeometry),A=n(11),I=n(12),D=function(){function e(t,n){Object(M.a)(this,e),this.length=t,this.elemSize=n,this.buffer=void 0,this.nextElemIndex=void 0,this.buffer=Array(n*t),this.nextElemIndex=0}return Object(A.a)(e,[{key:"addElem",value:function(){for(var e=this.nextElemIndex*this.elemSize,t=0;t<this.elemSize;t++)this.buffer[e+t]=t<0||arguments.length<=t?void 0:arguments[t];return this.nextElemIndex++}},{key:"getElem",value:function(e){var t=e*this.elemSize;return this.buffer.slice(t,t+this.elemSize)}},{key:"addCopyOf",value:function(e){return this.addElem.apply(this,Object(I.a)(this.getElem(e)))}},{key:"asAttribute",value:function(){return new m.Float32BufferAttribute(this.buffer,this.elemSize)}},{key:"asBuffer",value:function(){return this.buffer}},{key:"nextFreeElemIndex",value:function(){return this.nextElemIndex}},{key:"ensureFilled",value:function(e){if(this.nextElemIndex!==this.length)throw console.error(this),new Error("".concat(e," was not filled. Expected ").concat(this.length,", Actual ").concat(this.nextElemIndex,"."))}}]),e}(),H=function(e){function t(e){return Object(M.a)(this,t),Object(T.a)(this,Object(z.a)(t).call(this,e,2))}return Object(x.a)(t,e),Object(A.a)(t,[{key:"get",value:function(e){var t=this.getElem(e),n=Object(c.a)(t,2),a=n[0],i=n[1];return new m.Vector2(a,i)}},{key:"add",value:function(e,t){return this.addElem(e,t)}}]),t}(D),L=function(e){function t(e){return Object(M.a)(this,t),Object(T.a)(this,Object(z.a)(t).call(this,e,3))}return Object(x.a)(t,e),Object(A.a)(t,[{key:"get",value:function(e){var t=this.getElem(e),n=Object(c.a)(t,3),a=n[0],i=n[1],r=n[2];return new m.Vector3(a,i,r)}},{key:"add",value:function(e,t,n){return this.addElem(e,t,n)}}]),t}(D),_=function(e){function t(e){var n;Object(M.a)(this,t),(n=Object(T.a)(this,Object(z.a)(t).call(this))).className="ExtrusionGeometry",n.vertices=void 0,n.uvCoords=void 0,n.triangles=void 0;var a=e.frontFace,i=e.frontFaceHoles,r=e.backFace,o=e.backFaceHoles,s=e.smoothVertices,c=e.uvScale,l=n.countFaceVertices(a,i);if(l!==n.countFaceVertices(r,o))throw console.log(n.className,a,i,r,o),new Error("Mismatching Front and Back faces in "+n.className);var u=n.triangulateFace(a,i),h=n.triangulateFace(r,o),d=l+l+4*l-2*s.length,f=l;n.vertices=new L(d),n.uvCoords=new H(d);var m=u.length+h.length+2*l;n.triangles=new L(m),n.addFace(a,i,u,0,c,!1),n.addFace(r,o,h,f,c,!0);var g=0;return g=n.addSideFacesForPolygon(g,a.length,!1,s,0,f),i.forEach((function(e){g=n.addSideFacesForPolygon(g,e.length,!0,s,0,f)})),n.vertices.ensureFilled(n.className+".vertices"),n.uvCoords.ensureFilled(n.className+".uvCoords"),n.triangles.ensureFilled(n.className+".triangles"),n.setAttribute("position",n.vertices.asAttribute()),n.setAttribute("uv",n.uvCoords.asAttribute()),n.setIndex(n.triangles.asBuffer()),n.computeVertexNormals(),n}return Object(x.a)(t,e),Object(A.a)(t,[{key:"countFaceVertices",value:function(e,t){for(var n=e.length,a=0;a<t.length;a++)n+=t[a].length;return n}},{key:"toContour",value:function(e){return e.map((function(e){return new m.Vector2(e[0],e[1])}))}},{key:"triangulateFace",value:function(e,t){var n=this,a=this.toContour(e),i=t.map((function(e){return n.toContour(e)}));return m.ShapeUtils.triangulateShape(a,i)}},{key:"addVertexAndUV",value:function(e,t){return this.uvCoords.add(e[0]/t,e[1]/t),this.vertices.add(e[0],e[1],e[2])}},{key:"addFace",value:function(e,t,n,a,i,r){var o=this;e.forEach((function(e){return o.addVertexAndUV(e,i)})),t.forEach((function(e){return e.forEach((function(e){return o.addVertexAndUV(e,i)}))}));var s=a;n.forEach((function(e){var t=e[0]+s,n=e[r?2:1]+s,a=e[r?1:2]+s;o.triangles.add(t,n,a)}))}},{key:"addOrShareSideVertex",value:function(e,t,n){return n?t:(this.uvCoords.add(0,0),this.vertices.addCopyOf(e))}},{key:"addSideFacesForPolygon",value:function(e,t,n,a,i,r){for(var o=-1,s=-1,c=this.vertices.nextFreeElemIndex(),l=c+1,u=0;u<t;u++){var h=(u+1)%t,d=e+u,f=e+h,m=u>0&&d in a,g=this.addOrShareSideVertex(d+r,o,m),p=this.addOrShareSideVertex(d+i,s,m),b=0===h&&f in a,v=this.addOrShareSideVertex(f+r,c,b),y=this.addOrShareSideVertex(f+i,l,b);this.triangles.add(v,p,n?y:g),this.triangles.add(p,v,n?g:y),o=v,s=y}return e+t}}]),t}(m.BufferGeometry),R=function(e){function t(e){var n;return Object(M.a)(this,t),(n=Object(T.a)(this,Object(z.a)(t).call(this,e.lengthX,e.lengthZ,1,1))).className="GroundGeometry",n}return Object(x.a)(t,e),t}(m.PlaneBufferGeometry),U=function(e){var t=e.frontFace,n=e.frontFaceHoles,r=e.backFace,o=e.backFaceHoles,s=e.smoothVertices,c=e.uvScale,l=Object(j.a)(e,["frontFace","frontFaceHoles","backFace","backFaceHoles","smoothVertices","uvScale"]),u=Object(a.useMemo)((function(){return new _({frontFace:t,frontFaceHoles:n,backFace:r,backFaceHoles:o,smoothVertices:s,uvScale:c})}),[t,n,r,o,s,c]);return i.a.createElement(C,Object.assign({geometry:u},l))},G=function(e){var t=e.lengthX,n=e.lengthY,r=e.lengthZ,o=Object(j.a)(e,["lengthX","lengthY","lengthZ"]),s=Object(a.useMemo)((function(){return new V({lengthX:t,lengthY:n,lengthZ:r})}),[t,n,r]);return i.a.createElement(C,Object.assign({geometry:s},o))},W=function(e){var t=e.points,n=e.radius,r=Object(j.a)(e,["points","radius"]),o=Object(a.useMemo)((function(){return new P({points:t,radius:n})}),[t,n]);return i.a.createElement(C,Object.assign({geometry:o},r))},X=function(e){var t=e.origin,n=e.rotation,a=e.children,r=Object(F.b)({smoothedOrigin:t,smoothedRotation:n}),o=r.smoothedOrigin,s=r.smoothedRotation;return i.a.createElement(F.a.group,{position:o,rotation:s},a)},Z=function(e){var t=e.lengthX,n=e.lengthZ,r=Object(j.a)(e,["lengthX","lengthZ"]),o=Object(a.useMemo)((function(){return new R({lengthX:t,lengthZ:n})}),[t,n]);return i.a.createElement(C,Object.assign({id:"ground",geometry:o,rotation:[3*Math.PI/2,0,0],canSelect:!1,selected:!1,onFocusObject:function(){},gazeSize:[1,1,1],operable:!1,animateDoors:!1},r))};function B(e,t,n,a,r,o,s){return function e(c){return c.map((function(c){var l=c.id,u=c.type,h=c.material,d=c.children,f=Object(j.a)(c,["id","type","material","children"]),m=function(e){switch(e){case"extrusion":return U;case"cuboid":return G;case"pipe":return W;default:throw new Error("Unsupported mesh type ".concat(e))}}(u);return i.a.createElement(m,Object.assign({key:l,id:l,material:t[h],canSelect:a(l),selected:r(l),onFocusObject:n,animateDoors:s,visible:o||!c.id.startsWith("feature/")},f),d&&e(d)||[])}))}(e)}var N=n(10),J=n(35),Y=n(28),K=function(e){function t(e,n,a){var i;return Object(M.a)(this,t),(i=Object(T.a)(this,Object(z.a)(t).call(this,n,a))).listeners=e,i.minTransitionVelocity=1e3,i.minTransitionIdleDuration=.2,i.viewPadding=1.2,i.lastTarget=void 0,i.lastSpherical=void 0,i.lastZoom=void 0,i.doingTransition=void 0,i.currentTransitionIdleDuration=void 0,i.tempVec3=void 0,i.lastTarget=new m.Vector3,i.lastSpherical=new m.Spherical,i.lastZoom=1,i.doingTransition=!1,i.currentTransitionIdleDuration=0,i.tempVec3=new m.Vector3,i.update=i.update.bind(Object(N.a)(i)),i.reset=i.reset.bind(Object(N.a)(i)),i.notifyStartedTransition=i.notifyStartedTransition.bind(Object(N.a)(i)),i.notifyFinishedTransition=i.notifyFinishedTransition.bind(Object(N.a)(i)),i.notifyUpdatedView=i.notifyUpdatedView.bind(Object(N.a)(i)),i.onResize=i.onResize.bind(Object(N.a)(i)),i.resetView=i.resetView.bind(Object(N.a)(i)),i.setMode=i.setMode.bind(Object(N.a)(i)),i.setGaze=i.setGaze.bind(Object(N.a)(i)),i.worldToPage=i.worldToPage.bind(Object(N.a)(i)),window.addEventListener("resize",i.onResize),i}return Object(x.a)(t,e),Object(A.a)(t,[{key:"dispose",value:function(){window.removeEventListener("resize",this.onResize),Object(J.a)(Object(z.a)(t.prototype),"dispose",this).call(this)}},{key:"update",value:function(e){var n=Object(J.a)(Object(z.a)(t.prototype),"update",this).call(this,e);if(!this.lastSpherical)return n;var a=this.lastSpherical,i=a.theta,r=a.phi,o=a.radius,s=this.lastTarget.distanceTo(this._target)+o*Math.abs(i-this._spherical.theta)+o*Math.abs(r-this._spherical.phi)+Math.abs(o-this._spherical.radius)+o*Math.abs(this.lastZoom-this._zoom),c=Math.abs(e)<1e-6?0:s/e;return this.reset(),this.doingTransition&&c<this.minTransitionVelocity?(this.currentTransitionIdleDuration+=e,this.currentTransitionIdleDuration>=this.minTransitionIdleDuration&&(this.doingTransition=!1,this.listeners.forEach(this.notifyFinishedTransition))):c>=this.minTransitionVelocity&&(this.currentTransitionIdleDuration=0,this.doingTransition||(this.doingTransition=!0,this.listeners.forEach(this.notifyStartedTransition))),n&&this.listeners.forEach(this.notifyUpdatedView),n}},{key:"reset",value:function(){this.lastTarget.copy(this._target),this.lastSpherical.copy(this._spherical),this.lastZoom=this._zoom}},{key:"notifyStartedTransition",value:function(e){e.notifyStartedTransition(this)}},{key:"notifyFinishedTransition",value:function(e){e.notifyFinishedTransition(this)}},{key:"notifyUpdatedView",value:function(e){e.notifyUpdatedView(this,this.doingTransition)}},{key:"onResize",value:function(e){console.log("resizing fired"),this.listeners.forEach(this.notifyUpdatedView)}},{key:"resetView",value:function(e,t){var n=Object(c.a)(e,3),a=n[0],i=n[1],r=n[2],o=Object(c.a)(t,3),s=o[0],l=o[1],u=o[2];this.setLookAt(s,l,u,a,i,r,!1)}},{key:"setMode",value:function(e){if(this.mouseButtons){var t=Y.a.ACTION,n=t.ROTATE,a=t.TRUCK,i=e?n:a,r=i===n?a:n;this.mouseButtons.left=i,this.mouseButtons.right=r}}},{key:"setGaze",value:function(e,t,n){var a=Object(c.a)(n,3),i=a[0],r=a[1],o=a[2],s=this.viewPadding,l=this.getDistanceToFit(i*s,r*s,o*s),u=Object(c.a)(t,3),h=u[0],d=u[1],f=u[2];this.tempVec3.set(h,d,f).multiplyScalar(-l);var m=this.tempVec3,g=m.x,p=m.y,b=m.z,v=Object(c.a)(e,3),y=v[0],w=v[1],O=v[2];this.setLookAt(g+y,p+w,b+O,y,w,O,!0)}},{key:"worldToPage",value:function(e){e.project(this._camera);var t=this._domElement.getBoundingClientRect(),n=.5*t.width,a=.5*t.height,i=t.left+window.scrollX,r=t.top+window.scrollY;return e.x=n*(1+e.x)+i,e.y=a*(1-e.y)+r,!0}}]),t}(Y.a),Q=new(function(){function e(){Object(M.a)(this,e),this.camera=void 0,this.domElement=void 0,this.cameraControls=void 0,this.listeners=void 0,Y.a.install({THREE:m}),this.camera=void 0,this.domElement=void 0,this.cameraControls=void 0,this.listeners=new Map,this.addListener=this.addListener.bind(this),this.removeListener=this.removeListener.bind(this),this.setCamera=this.setCamera.bind(this),this.updateFrame=this.updateFrame.bind(this),this.getCameraControls=this.getCameraControls.bind(this)}return Object(A.a)(e,[{key:"addListener",value:function(e,t){var n;(this.listeners.set(e,t),this.cameraControls)&&(null===(n=this.camera)||void 0===n||n.updateWorldMatrix(!0,!1),t.notifyUpdatedView(this.cameraControls,!1))}},{key:"removeListener",value:function(e){this.listeners.delete(e)}},{key:"setCamera",value:function(e,t){var n,a=this;this.camera===e&&this.domElement===t||(this.cameraControls&&(this.cameraControls.dispose(),this.cameraControls=void 0),this.camera=e,this.domElement=t,this.camera&&this.domElement&&(this.cameraControls=new K(this.listeners,this.camera,this.domElement)),this.cameraControls&&(this.cameraControls.reset(),null===(n=this.camera)||void 0===n||n.updateWorldMatrix(!0,!1),this.listeners.forEach((function(e){return e.notifyUpdatedView(a.cameraControls,!1)}))))}},{key:"updateFrame",value:function(e){var t;null===(t=this.cameraControls)||void 0===t||t.update(e),k.a.update()}},{key:"getCameraControls",value:function(){return this.cameraControls}}]),e}()),q=function(e){var t=e.counter,n=e.gazeDirection,r=e.gazeTarget,o=e.gazeSize,s=e.orthographic,c=e.startLookAt,l=e.startPosition,u=e.showJunctionAngles,h=Object(a.useRef)(),d=Object(E.f)(),f=d.gl,m=d.setDefaultCamera;Object(a.useEffect)((function(){h.current&&m(h.current)}),[h,m]),Object(a.useEffect)((function(){Q.setCamera(h.current,f.domElement)}),[h,f]),Object(a.useEffect)((function(){var e;null===(e=Q.getCameraControls())||void 0===e||e.resetView(c,l)}),[l,c]),Object(a.useEffect)((function(){var e;r&&n&&o&&(null===(e=Q.getCameraControls())||void 0===e||e.setGaze(r,n,o))}),[t,n,r,o]),Object(a.useEffect)((function(){var e;null===(e=Q.getCameraControls())||void 0===e||e.setMode(u)}),[u]),Object(E.e)((function(e,t){Q.updateFrame(t)}));return s?i.a.createElement("orthographicCamera",{ref:h,position:l,far:1e4}):i.a.createElement("perspectiveCamera",{ref:h,position:l,near:10,far:1e4,fov:60})},$=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("ambientLight",{intensity:.9}))},ee=n(29),te=function(){function e(t,n,a,i,r,o,s){Object(M.a)(this,e),this.startParentID=t,this.finishParentID=a,this.ref=r,this.notifyShowingChanged=o,this.allowShow=s,this.startLocal=void 0,this.startWorld=void 0,this.finishLocal=void 0,this.finishWorld=void 0,this.midPoint=void 0,this.startLocal=new m.Vector3(n[0],n[1],n[2]),this.startWorld=new m.Vector3,this.finishLocal=new m.Vector3(i[0],i[1],i[2]),this.finishWorld=new m.Vector3,this.midPoint=new m.Vector3,this.localToWorld=this.localToWorld.bind(this),this.updatePosition=this.updatePosition.bind(this),this.notifyStartedTransition=this.notifyStartedTransition.bind(this),this.notifyFinishedTransition=this.notifyFinishedTransition.bind(this),this.notifyUpdatedView=this.notifyUpdatedView.bind(this)}return Object(A.a)(e,[{key:"localToWorld",value:function(e,t,n){var a,i=null===(a=g.get(e))||void 0===a?void 0:a.mesh;return!!i&&(n.copy(t),i.localToWorld(n),!0)}},{key:"updatePosition",value:function(e){if(this.ref.current&&this.localToWorld(this.startParentID,this.startLocal,this.startWorld)&&this.localToWorld(this.finishParentID,this.finishLocal,this.finishWorld)&&(this.midPoint.addVectors(this.startWorld,this.finishWorld).multiplyScalar(.5),e.worldToPage(this.midPoint))){var t=this.midPoint,n=t.x,a=t.y;this.ref.current.style.transform="translate(-50%, -50%) translate(".concat(n,"px,").concat(a,"px)")}}},{key:"notifyStartedTransition",value:function(e){this.notifyShowingChanged(!1)}},{key:"notifyFinishedTransition",value:function(e){this.allowShow&&(this.notifyShowingChanged(!0),this.updatePosition(e))}},{key:"notifyUpdatedView",value:function(e,t){t||this.updatePosition(e)}}]),e}(),ne=function(e){var t=e.measurement,n=e.allowShow,r=(Object(j.a)(e,["measurement","allowShow"]),t.id),o=t.length,s=t.start,l=t.finish,u=Object(a.useState)(o),h=Object(c.a)(u,2),d=h[0],f=h[1],m=Object(ee.c)((function(){return{opacity:0,config:ee.b.stiff}})),g=Object(c.a)(m,2),p=g[0],b=g[1],v=Object(a.useRef)();Object(a.useEffect)((function(){b({opacity:n?1:0})}),[n,b]),Object(a.useEffect)((function(){if(v.current&&n){var e=new te(s.parentId,s.origin,l.parentId,l.origin,v,(function(e){return b({opacity:e?1:0})}),n);return Q.addListener(r,e),function(){Q.removeListener(r)}}}),[s.parentId,s.origin,l.parentId,l.origin,v,n,b,r]);var y=Object(a.useCallback)((function(e){return f(Number(e.target.value))}),[f]);return i.a.createElement(ee.a.input,{ref:v,type:"text",className:"measurement",value:d,style:p,onChange:y})};var ae=Object(s.b)((function(e){var t=e.rendererState,n=t.counter,a=t.gazeDirection,i=t.gazeTarget,r=t.gazeSize,o=t.orthographic,s=t.selected,c=t.selectionFilter,l=t.showJunctionAngles,u=t.showGround,h=t.showHardware,f=t.showMeasurements,m=t.animateDoors;return{counter:n,gazeDirection:a,gazeTarget:i,gazeSize:r,orthographic:o,scene:d,canSelect:function(e){return e.startsWith(c)},isSelected:function(e){return e===s},showJunctionAngles:l,showGround:u,showHardware:h,showMeasurements:f,animateDoors:m}}),(function(e){return{onFocusObject:function(t,n){return e(b(t,n))}}}))((function(e){var t=e.materialLibrary,n=e.onFocusObject,a=e.canSelect,r=e.isSelected,o=e.showJunctionAngles,s=e.showGround,l=e.showHardware,u=e.showMeasurements,h=e.animateDoors,d=e.scene,f=Object(j.a)(e,["materialLibrary","onFocusObject","canSelect","isSelected","showJunctionAngles","showGround","showHardware","showMeasurements","animateDoors","scene"]),g=d.junctionAngles,p=d.defaultCamera,b=d.positions;return i.a.createElement("div",{className:"gl-view"},i.a.createElement(E.a,null,i.a.createElement(q,Object.assign({startLookAt:p.lookAt,startPosition:p.position,showJunctionAngles:o},f)),i.a.createElement($,null),i.a.createElement(Z,{lengthX:d.ground.lengthX,lengthZ:d.ground.lengthZ,origin:d.ground.origin,material:t.ground,visible:s,children:[]}),function(e){for(var s=new m.Vector3(0,1,0),u=Array(e.positions.length),d=Object(c.a)(e.origin,3),f=d[0],p=d[1],v=d[2],y=new m.Vector3(f,p,v),w=0,O=0;O<b.length;O++){var S=e.positions[O],j=Object(c.a)(S.offset,3),E=j[0],F=j[1],k=j[2];o?w+=m.MathUtils.DEG2RAD*g[O]:(k=0,E+=150),u[O]=i.a.createElement(X,{key:O,origin:[y.x,y.y,y.z],rotation:[0,w,0]},B(S.children,t,n,a,r,l,h)),y.add(new m.Vector3(E,F,k).applyAxisAngle(s,w))}return u}(d)),d.measurements.map((function(e){return i.a.createElement(ne,{key:e.id,measurement:e,allowShow:u})})))})),ie=(new m.CubeTextureLoader).setPath("img/envMap/").load(["px.png","nx.png","py.png","ny.png","pz.png","nz.png"]),re=((new m.CubeTextureLoader).setPath("img/bgMap/").load(["px.png","nx.png","py.png","ny.png","pz.png","nz.png"]),(new m.TextureLoader).load("img/bg-texture.jpg"));re.wrapS=m.MirroredRepeatWrapping,re.wrapT=m.MirroredRepeatWrapping,re.repeat.set(24,24);var oe=m.DoubleSide,se={standard:new m.MeshPhysicalMaterial({metalness:.3,roughness:.3,reflectivity:.99,clearcoat:.95,clearcoatRoughness:.1,transparent:!0,side:oe,envMap:ie,color:11010027,opacity:.75}),hover:new m.MeshPhysicalMaterial({metalness:.3,roughness:.3,reflectivity:.99,clearcoat:.95,clearcoatRoughness:.1,transparent:!0,side:oe,envMap:ie,color:6619098,opacity:.9}),selected:new m.MeshPhysicalMaterial({metalness:.3,roughness:.3,reflectivity:.99,clearcoat:.95,clearcoatRoughness:.1,transparent:!0,side:oe,envMap:ie,color:49061,opacity:.95})},ce={standard:new m.MeshPhongMaterial({shininess:.1,envMap:ie,reflectivity:.1,color:11010027}),hover:new m.MeshPhongMaterial({shininess:.1,envMap:ie,reflectivity:.1,color:6619098}),selected:new m.MeshPhongMaterial({shininess:.1,envMap:ie,reflectivity:.1,color:49061})},le={standard:new m.MeshPhysicalMaterial({metalness:1,roughness:.1,clearcoat:.1,clearcoatRoughness:.2,envMap:ie,color:16761095}),hover:new m.MeshPhysicalMaterial({metalness:1,roughness:.1,clearcoat:.1,clearcoatRoughness:.2,envMap:ie,color:16748288}),selected:new m.MeshPhysicalMaterial({metalness:1,roughness:.1,clearcoat:.1,clearcoatRoughness:.2,envMap:ie,color:15094016})},ue={standard:new m.MeshPhongMaterial({shininess:.9,envMap:ie,reflectivity:.9,color:16761095}),hover:new m.MeshPhongMaterial({shininess:.9,envMap:ie,reflectivity:.9,color:16748288}),selected:new m.MeshPhongMaterial({shininess:.9,envMap:ie,reflectivity:.9,color:15094016})},he=new m.MeshBasicMaterial({map:re,color:15658734}),de=new m.MeshBasicMaterial({color:15658734}),fe={glass:se,metal:le,ground:{standard:he,hover:he,selected:he}},me={glass:ce,metal:ue,ground:{standard:de,hover:de,selected:de}};var ge=Object(s.b)((function(e){var t=e.rendererState;return{showJunctionAngles:t.showJunctionAngles,showGround:t.showGround,showHardware:t.showHardware,showMeasurements:t.showMeasurements,animateDoors:t.animateDoors,selectionFilter:t.selectionFilter}}),(function(e){return{onShowJunctionAngles:function(t){e(v({showJunctionAngles:t})),e(b("panel/1",!1))},onShowGround:function(t){return e(v({showGround:t}))},onShowHardware:function(t){return e(v({showHardware:t}))},onShowMeasurements:function(t){return e(v({showMeasurements:t}))},onAnimateDoors:function(t){return e(v({animateDoors:t}))},onFocusObject:function(t,n){return e(b(t,n))},onSetSelectionFilter:function(t){return e({type:"SET_SELECTION_FILTER",payload:{selectionFilter:t}})}}}))((function(e){var t=e.showJunctionAngles,n=e.showGround,r=e.showHardware,o=e.showMeasurements,s=e.animateDoors,l=e.selectionFilter,u=e.onShowJunctionAngles,h=e.onShowGround,d=e.onShowHardware,f=e.onShowMeasurements,m=e.onAnimateDoors,g=e.onFocusObject,p=e.onSetSelectionFilter,b=Object(a.useState)(!0),v=Object(c.a)(b,2),y=v[0],w=v[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{position:"fixed",zIndex:1}},i.a.createElement("button",{type:"button",onClick:function(){return w(!y)}},"Switch to ",y?"Fast":"Full"),i.a.createElement("button",{type:"button",onClick:function(){return u(!t)}},"Show ",t?"Flat":"Angled"),i.a.createElement("button",{type:"button",onClick:function(){return d(!r)}},r?"Hide":"Show"," Hardware"),i.a.createElement("button",{type:"button",onClick:function(){return h(!n)}},n?"Hide":"Show"," Ground"),i.a.createElement("button",{type:"button",onClick:function(){return f(!o)}},o?"Hide":"Show"," Measurements"),i.a.createElement("button",{type:"button",onClick:function(){return m(!s)}},s?"Stop Animation":"Animate Doors"),"\xa0Allow Select:",i.a.createElement("button",{type:"button",onClick:function(){return p("")}},"All"),i.a.createElement("button",{type:"button",onClick:function(){return p("panel/")}},"Panels"),i.a.createElement("button",{type:"button",onClick:function(){return p("feature/")}},"HW"),"\xa0Select:",i.a.createElement("button",{type:"button",disabled:"feature/"===l,onClick:function(){return g("panel/1",!0)}},"P1"),i.a.createElement("button",{type:"button",disabled:"feature/"===l,onClick:function(){return g("panel/2",!0)}},"P2"),i.a.createElement("button",{type:"button",disabled:"panel/"===l||!r,onClick:function(){return g("feature/6",!0)}},"Handle"),"\xa0Focus:",i.a.createElement("button",{type:"button",onClick:function(){return g("panel/3",!1)}},"P3"),i.a.createElement("button",{type:"button",onClick:function(){return g("panel/4",!1)}},"P4"),i.a.createElement("button",{type:"button",disabled:!r,onClick:function(){return g("feature/1",!1)}},"BotHinge")),i.a.createElement(ae,{materialLibrary:y?fe:me}))})),pe=n(21),be=Object(pe.b)({rendererState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FOCUS_OBJECT":return w(e,t);case"MODIFY_DISPLAY":return O(e,t);case"SET_SELECTION_FILTER":return S(e,t);default:return e}}}),ve=Object(pe.c)(be,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());o.a.render(i.a.createElement(s.a,{store:ve},i.a.createElement(ge,null)),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.645f82b0.chunk.js.map