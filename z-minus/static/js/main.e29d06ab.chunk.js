(this["webpackJsonpz-minus"]=this["webpackJsonpz-minus"]||[]).push([[0],{40:function(e,t,i){e.exports=i(50)},45:function(e,t,i){},48:function(e,t,i){},49:function(e,t,i){},50:function(e,t,i){"use strict";i.r(t);var n=i(7),a=i.n(n),r=i(37),s=i.n(r),o=(i(45),i(10)),h=i(17),u=i.n(h),c=u.a.mark(f),l=u.a.mark(v),d=u.a.mark(p);function f(e,t,i){var n,a;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=t.subtract(e.position).normalize(),a=n.clone();case 2:if(!(o.j.Dot(n,a)>0)){r.next=11;break}return n.normalize().scaleToRef(e.unitType.maxSpeed,e.velocity),void(r.next=6);case 6:if(!i(e)){r.next=8;break}return r.abrupt("break",11);case 8:t.subtractToRef(e.position,a),r.next=2;break;case 11:e.velocity.scaleInPlace(0);case 12:case"end":return r.stop()}}),c)}function v(e,t){return u.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return e.angularVelocity=Math.PI*(1===e.owner.id?3:-3),i.delegateYield(p(e,t),"t0",2);case 2:e.angularVelocity=0;case 3:case"end":return i.stop()}}),l)}function p(e,t){return u.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t(e)){i.next=5;break}return void(i.next=3);case 3:i.next=0;break;case 5:case"end":return i.stop()}}),d)}function m(e){return Math.floor(Math.random()*e)}function y(e){if(e.length>0)return e[m(e.length)]}function g(e,t){if(0!==e.length){for(var i=e.map(t),n=m(function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i];return t}(i)),a=0;a<i.length;a++)if((n-=i[a])<0)return e[a];return e[e.length-1]}}function w(e,t){return e.filter(t).length}var k=u.a.mark(x),b=u.a.mark(S),M=u.a.mark(U);function T(e){var t=e.tile;return!!t&&(t.occupancy[e.owner.opponent.id]>0||(t.owner===e.owner.opponent||(t.owner===e.owner&&t.healthProportion()<.99||!(t!==e.owner.homeTile||!e.isDamaged()))))}function x(e,t,i){var n;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=function(){return e.isDamaged()?t.neighbourClosestTo(e.tile,e.owner.homeTile):g(t.neighbours(e.tile),i)||e.owner.homeTile};case 1:if(!T){a.next=4;break}return a.delegateYield(v(e,T),"t0",4);case 4:return a.delegateYield(f(e,n().toPos(),T),"t1",5);case 5:a.next=1;break;case 7:case"end":return a.stop()}}),k)}function S(e,t){return u.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.delegateYield(x(e,t,(function(t){var i=Math.abs(e.owner.id-t.owner.id)+1;return i*i*i})),"t0",1);case 1:case"end":return i.stop()}}),b)}function U(e,t){return u.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.delegateYield(x(e,t,(function(t){var i=2-Math.abs(e.owner.id-t.owner.id)+1;return i*i*i})),"t0",1);case 1:case"end":return i.stop()}}),M)}var C={id:0,displayName:"Offensive",maxHealth:10,maxSpeed:1.5,attackVsUnit:4,attackVsTile:2,repairTile:.5,repairSelf:.5,meshFactory:function(e,t,i){var n={diameter:2*t,height:i,tessellation:3,enclose:!0};return o.g.CreateCylinder("offUnit",n,e)},aiFactory:function(e,t){return S(e,t)}},j={id:1,displayName:"Defensive",maxHealth:15,maxSpeed:2,attackVsUnit:3,attackVsTile:.25,repairTile:2,repairSelf:1,meshFactory:function(e,t,i){var n={diameter:1.7*t,height:i,tessellation:5,enclose:!0};return o.g.CreateCylinder("defUnit",n,e)},aiFactory:function(e,t){return U(e,t)}};var P,O={id:2,displayName:"Random",imgName:"rand",nextUnitType:function(){return y([C,j])}},E={minDurationState:.05,minDurationUI:.2,tileSize:2,drawnTileSize:1.96,unitCost:10,tileMaxHealth:20,homeTileMaxHealth:50,tileControlThreshold:.8,minUnitsToCapture:2,resourcesRate:1,unitTypes:[C,j],unitProdStrategies:[{id:0,displayName:"Offensive",imgName:"off",nextUnitType:function(){return C}},{id:1,displayName:"Defensive",imgName:"def",nextUnitType:function(){return j}},O],defaultUPS:O},I=i(13),H=i(16),z=i(21);function R(e,t){if(t(e),e.children)for(var i=0;i<e.children.length;i++)R(e.children[i],t)}!function(e){e[e.Game=0]="Game",e[e.Player=1]="Player",e[e.Board=2]="Board",e[e.Tile=3]="Tile",e[e.Unit=4]="Unit"}(P||(P={}));var N=function(){function e(t,i,n,a,r,s){var h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;Object(I.a)(this,e),this.game=t,this.owner=i,this.isHome=n,this.resMult=a,this.type=P.Tile,this.viewObj=void 0,this.coords=void 0,this.health=void 0,this.maxHealth=void 0,this.occupancy=void 0,void 0===h?h=-(r+s):r+s+h!==0&&console.error("Attempting to create an invalid Tile",{q:r,r:s,s:h}),this.coords=new o.j(r,s,h),this.maxHealth=n?E.homeTileMaxHealth:E.tileMaxHealth,this.health=n?this.maxHealth:0,this.occupancy=[0,0,0]}return Object(H.a)(e,[{key:"generate",value:function(e){e.generateTile(this)}},{key:"updateState",value:function(e,t){var i=E.resourcesRate,n=E.tileControlThreshold;this.resolveUnits(this.game.aliveUnits,t),this.healthProportion()>n&&(this.owner.resourceCount+=t*i*this.resMult)}},{key:"draw",value:function(e){e.drawTile(this)}},{key:"equals",value:function(e){return this.coords.equals(e.coords)}},{key:"healthProportion",value:function(){return Math.min(1,Math.max(0,this.health/this.maxHealth))}},{key:"incHealth",value:function(e,t){var i=this.health+e*t;this.health=Math.min(this.maxHealth,Math.max(0,i))}},{key:"harm",value:function(e,t){this.incHealth(-e,t)}},{key:"heal",value:function(e,t){this.incHealth(e,t)}},{key:"canCapture",value:function(e){return this.owner===this.game.gaia&&e.length>=E.minUnitsToCapture}},{key:"resolveUnits",value:function(e,t){var i=this,n=e.filter((function(e){return e.tile===i}));if(0!==n.length){var a=Object(z.a)(this.game.players,3),r=a[0],s=a[1],o=a[2],h=n.filter((function(e){return e.owner===s})),u=n.filter((function(e){return e.owner===o}));if(this.occupancy=[0,h.length,u.length],h.length>0&&u.length>0)h.forEach((function(e){return e.attackUnit(y(u),t)})),u.forEach((function(e){return e.attackUnit(y(h),t)}));else{var c=n[0].owner;this.canCapture(n)&&(this.owner=c),this.owner===c?n.forEach((function(e){return e.repair(i,t)})):this.owner!==r&&(n.forEach((function(e){return e.attackTile(i,t)})),this.healthProportion()<.1&&(this.owner=r))}}}},{key:"toPosOffset",value:function(e,t){var i=this.coords,n=i.x,a=i.y,r=n+e.x*t,s=a+e.y*t;return new o.j(1.5*r*E.tileSize,0,B*(.5*r+s)*E.tileSize)}},{key:"toPos",value:function(){return this.toPosOffset(o.j.Zero(),0)}}],[{key:"distBetween",value:function(e,t){var i=e.coords.subtract(t.coords),n=i.x,a=i.y,r=i.z;return.5*(Math.abs(n)+Math.abs(a)+Math.abs(r))}},{key:"roundCoords",value:function(e,t){var i=-e-t,n=Math.round(e),a=Math.round(t),r=Math.round(i),s=Math.abs(e-n),o=Math.abs(t-a),h=Math.abs(i-r);return s>Math.max(o,h)?{q:-a-r,r:a}:o>h?{q:n,r:-n-r}:{q:n,r:a}}}]),e}();N.direction={NN:new o.j(0,1,-1),NE:new o.j(1,0,-1),SE:new o.j(1,-1,0),SS:new o.j(0,-1,1),SW:new o.j(-1,0,1),NW:new o.j(-1,1,0)},N.directions=[N.direction.NN,N.direction.NE,N.direction.SE,N.direction.SS,N.direction.SW,N.direction.NW];var V,B=Math.sqrt(3),F=function(){function e(t,i,n){Object(I.a)(this,e),this.game=t,this.radius=i,this.type=P.Board,this.children=void 0,this.tiles=void 0,this.tiles=[],this.children=[];for(var a=i,r=-a;r<=a;r++){this.tiles[r+a]=[];for(var s=-a;s<=a;s++){var o=-(r+s);if(-a<=o&&o<=a&&n(r,s,o)){var h=0===r&&Math.abs(s)===a,u=t.players[h?s===a?1:2:0],c=Math.abs(r)<=1&&Math.abs(o-s)>=2,l=new N(t,u,h,h||o===s?2:c?.5:1,r,s);this.tiles[r+a][s+a]=l,this.children.push(l)}}}}return Object(H.a)(e,[{key:"tile",value:function(e,t){var i=this.radius;if(-i<=e&&e<=i&&-i<=t&&t<=i)return this.tiles[e+i][t+i]}},{key:"tileList",value:function(){return this.children}},{key:"neighbours",value:function(e){var t=this;return N.directions.map((function(i){return t.neighbour(e,i)})).filter((function(e){return!!e}))}},{key:"neighbourClosestTo",value:function(e,t){var i=this.neighbours(e);if(0===i.length)return t;for(var n=i.map((function(e){return N.distBetween(e,t)})),a=0,r=1;r<i.length;r++)n[r]<n[a]&&(a=r);return i[a]}},{key:"neighbour",value:function(e,t){return this.tile(e.coords.x+t.x,e.coords.y+t.y)}},{key:"posToTile",value:function(e){var t=e.x/E.tileSize,i=e.z/E.tileSize,n=N.roundCoords(2/3*t,(L*i-t)/3),a=n.q,r=n.r;return this.tile(a,r)}}]),e}(),L=Math.sqrt(3),D=i(23),A=function(){function e(t,i,n,a,r){Object(I.a)(this,e),this.game=t,this.id=i,this.name=n,this.hue=a,this.maxSaturation=r,this.type=P.Player,this.stdTileColor=void 0,this.homeTileColor=void 0,this.fullUnitColor=void 0,this.deadUnitColor=void 0,this.opponent=void 0,this.homeTile=void 0,this.resourceCount=void 0,this.ups=void 0,this.stdTileColor=e.color(a,.4*r,.8),this.homeTileColor=e.color(a,.8*r,.6),this.fullUnitColor=e.color(a,.9*r,.95),this.deadUnitColor=e.color(a,.4*r,.3,.3),this.resourceCount=0,this.ups=E.defaultUPS,this.homeTile=void 0,this.opponent=void 0}return Object(H.a)(e,[{key:"generate",value:function(e){var t=this;this.homeTile=this.game.board.tileList().find((function(e){return e.owner===t&&e.isHome})),this.opponent=this.game.players.find((function(e){return e.id>0&&e.id!==t.id}))}},{key:"updateState",value:function(e,t){for(;this.resourceCount>E.unitCost;)this.resourceCount-=E.unitCost,this.game.spawnUnit(this,this.ups.nextUnitType(),this.homeTile)}},{key:"isAlive",value:function(){return this.homeTile.owner===this}},{key:"tileColor",value:function(t,i){var n=(t?.8:.4)*i*this.maxSaturation,a=t?.6:.8;return e.color(this.hue,n,a)}}],[{key:"color",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=new o.b;o.b.HSVtoRGBToRef(e,t,i,a);var r=a.r,s=a.g,h=a.b;return new o.c(r,s,h,n)}}]),e}();!function(e){e[e.active=0]="active",e[e.dead=1]="dead",e[e.won=2]="won",e[e.lost=3]="lost"}(V||(V={}));var Y=2*Math.PI,G=function(){function e(t,i,n,a,r,s){Object(I.a)(this,e),this.game=t,this.id=i,this.owner=n,this.unitType=a,this.tile=r,this.position=s,this.type=P.Unit,this.viewObj=void 0,this.state=void 0,this.velocity=void 0,this.angularVelocity=void 0,this.rotY=void 0,this.health=void 0,this.ai=void 0,this.state=V.active,this.velocity=new o.j,this.angularVelocity=0,this.rotY=0,this.health=this.unitType.maxHealth,this.ai=void 0}return Object(H.a)(e,[{key:"generate",value:function(e){e.generateUnit(this),this.ai=this.unitType.aiFactory(this,this.game.board)}},{key:"updateFrame",value:function(e,t){if(this.state!==V.dead&&this.state!==V.lost){this.velocity.scaleAndAddToRef(t,this.position);var i=this.rotY+this.angularVelocity*t;i>=Y?i-=Y:i<0&&(i+=Y),this.rotY=i}var n=.05+.01*this.owner.id;switch(this.state){case V.active:this.position.y=n;break;case V.won:var a=.2*(this.id%3+1)*(.8+Math.sin(this.rotY));this.position.y=n+Math.max(0,a);break;case V.lost:case V.dead:this.position.y=n-.001}}},{key:"updateState",value:function(e,t){if((this.health<=.001&&this.setState(V.dead),this.state===V.active)&&(this.ai.next(t),this.tile=this.game.board.posToTile(this.position)||this.owner.homeTile,this.velocity.length()>.1)){var i=o.j.Dot(o.j.Forward(),this.velocity);this.rotY=Math.PI/6+Math.acos(i/this.velocity.length())}}},{key:"draw",value:function(e){e.drawUnit(this)}},{key:"healthProportion",value:function(){return this.health/this.unitType.maxHealth}},{key:"incHealth",value:function(e,t){var i=this.health+e*t;this.health=Math.min(this.unitType.maxHealth,Math.max(0,i))}},{key:"harm",value:function(e,t){this.incHealth(-e,t)}},{key:"heal",value:function(e,t){this.incHealth(e,t)}},{key:"attackUnit",value:function(e,t){e.harm(this.unitType.attackVsUnit,t)}},{key:"attackTile",value:function(e,t){e.harm(this.unitType.attackVsTile,t)}},{key:"repair",value:function(e,t){e.heal(this.unitType.repairTile,t),this.game.canHeal(this,e)&&this.heal(this.unitType.repairSelf,t)}},{key:"isAlive",value:function(){return this.state===V.active||this.state===V.won}},{key:"isDamaged",value:function(){return this.healthProportion()<.99}},{key:"setState",value:function(e){if(this.state!==e){switch(e){case V.won:this.velocity.scaleInPlace(0),this.angularVelocity=this.id%4*2-3;break;case V.dead:case V.lost:this.ai=void 0,this.velocity.scaleInPlace(0)}this.state=e}}}]),e}(),q=function(){function e(){Object(I.a)(this,e),this.type=P.Game,this.children=void 0,this.view=void 0,this.players=void 0,this.gaia=void 0,this.board=void 0,this.aliveUnits=void 0,this.winner=void 0,this.gaia=new A(this,0,"Gaia",180,.01);var t=new A(this,1,"Green",120,1),i=new A(this,2,"Red",0,1);this.players=[this.gaia,t,i],this.board=new F(this,2,(function(){return!0})),this.aliveUnits=[],this.winner=void 0,this.children=[this.board].concat(Object(D.a)(this.players),Object(D.a)(this.aliveUnits))}return Object(H.a)(e,[{key:"generate",value:function(e){this.view=e}},{key:"updateState",value:function(e,t){this.aliveUnits=this.children.filter((function(e){return e.type===P.Unit&&e.isAlive()}));for(var i=1;i<this.players.length;i++)this.players[i].isAlive()||this.finishGame(this.players[i].opponent)}},{key:"startGame",value:function(){var e=Object(z.a)(this.players,3),t=e[1],i=e[2],n=this.board.neighbours(t.homeTile),a=this.board.neighbours(i.homeTile),r=Object(z.a)(E.unitTypes,2),s=r[0],o=r[1];this.spawnUnit(t,o,t.homeTile),this.spawnUnit(i,o,i.homeTile),this.spawnUnit(t,s,n[1]),this.spawnUnit(i,s,a[0])}},{key:"spawnUnit",value:function(e,t,i){var n=this.children.length,a=new G(this,n,e,t,i,i.toPos());this.view&&a.generate(this.view),this.children.push(a),this.aliveUnits.push(a)}},{key:"running",value:function(){return void 0===this.winner}},{key:"finishGame",value:function(e){this.winner=e;for(var t=0;t<this.aliveUnits.length;t++){var i=this.aliveUnits[t];i.setState(i.owner===e?V.won:V.lost)}}},{key:"canHeal",value:function(e,t){return t.isHome&&e.owner===t.owner&&t.healthProportion()>E.tileControlThreshold}}]),e}(),W=i(38),J=i(27),Z=i(39),$=(i(48),{marginTop:"0.5em",marginLeft:"0.25em",marginRight:"0.25em",width:"8em",height:"8em",backgroundSize:"contain",outline:"none",boxShadow:"none",border:0}),K=function(e){var t=e.text,i=e.active,n=e.onClick,r=e.style,s=Object(J.a)({},$,{},r,{backgroundColor:i?"white":"transparent",transition:i?"background-color 0.5s":"background-color 7s"}),o="option-button-"+(i?"active":"clickable");return a.a.createElement(Z.a.button,{style:s,onClick:n,className:o},t)},Q={zIndex:100,color:"whitesmoke",margin:"auto",fontSize:"1em"},X=function(e){var t=e.view,i=e.style,r=e.getMessage,s=Object(n.useState)(""),o=Object(z.a)(s,2),h=o[0],u=o[1];Object(n.useEffect)(t.useListenerEffect((function(){return u(r(t))})),[t,u,r]);var c=i?Object(J.a)({},Q,{},i):Q;return a.a.createElement("div",{style:c},h)},_={position:"absolute",zIndex:99,padding:"10px",bottom:0,margin:"auto"},ee=function(e){var t=e.view,i=e.playerIndex,r=e.style,s=Object(n.useCallback)((function(){return t.getPlayerStatus(i)}),[t,i]),o=Object(n.useState)(void 0),h=Object(z.a)(o,2),u=h[0],c=h[1];Object(n.useEffect)(t.useListenerEffect((function(){return c(t.getPlayerUPS(i))})),[t,c,i]);var l=r?Object(J.a)({},_,{},r):_;return a.a.createElement("div",{style:l},a.a.createElement(X,{view:t,getMessage:s}),E.unitProdStrategies.map((function(e){return a.a.createElement(K,{key:e.id,text:"",active:e===u,style:{backgroundImage:'url("/z-minus/img/'.concat(e.imgName,"-").concat(i,'.png")')},onClick:function(){return t.setPlayerUPS(i,e)}})})))},te=function(){function e(t){Object(I.a)(this,e),this.scene=t}return Object(H.a)(e,[{key:"makeTileMesh",value:function(t){e.tileMesh||(e.tileMesh=e.generateTileMesh(this.scene,E.drawnTileSize));var i=t.coords,n=i.x,a=i.y,r=i.z,s=e.tileMesh.createInstance("tileMesh/".concat(n,"/").concat(a,"/").concat(r));return s.position.copyFrom(t.toPos()),s.isVisible=!0,s}},{key:"makeResourceMesh",value:function(t,i){if(!e.resourceMesh){var n=.07*E.drawnTileSize;e.resourceMesh=e.generateResourceMesh(this.scene,n)}var a=t.coords,r=a.x,s=a.y,o=a.z,h=e.resourceMesh.createInstance("resMesh/".concat(r,"/").concat(s,"/").concat(o,"/").concat(i)),u=t.toPosOffset(N.directions[i],.3);return h.position.x=u.x,h.position.z=u.z,h.rotation.y=i*Math.PI/6,h.isVisible=!0,h}},{key:"unitMeshPrototype",value:function(t){var i=t.unitType.id;return e.unitMesh[i]||(e.unitMesh[i]=e.generateUnitMesh(this.scene,t,.4,.1)),e.unitMesh[i]}},{key:"makeUnitMesh",value:function(e){var t=this.unitMeshPrototype(e).createInstance("unitMesh/".concat(e.id));return t.isVisible=!0,t.instancedBuffers.color=e.owner.fullUnitColor,t.position.copyFrom(e.position),t}}],[{key:"generateTileMesh",value:function(e,t){var i=new o.i("tileMeshMaterial",e);i.specularColor=new o.b(.5,.6,.87);var n=o.g.CreateDisc("tileMesh",{radius:t,tessellation:6,sideOrientation:o.f.DOUBLESIDE},e);return n.receiveShadows=!0,n.rotation.x=.5*Math.PI,n.material=i,n.isVisible=!1,n.registerInstancedBuffer("color",4),n.instancedBuffers.color=new o.c(1,1,1,1),n}},{key:"generateResourceMesh",value:function(e,t){var i=new o.i("resMeshMaterial",e);i.specularColor=new o.b(.5,.6,.87),i.diffuseColor=new o.b(1,.9,0);var n=t,a=t,r=o.g.CreateBox("resourceMesh",{width:n,depth:.05,height:a},e);return r.receiveShadows=!0,r.rotation.x=.5*Math.PI,r.position.y=0,r.material=i,r.isVisible=!1,r}},{key:"generateUnitMesh",value:function(e,t,i,n){var a=new o.i("unitMeshMaterial",e);a.specularColor=new o.b(.8,.8,.9);var r=t.unitType.meshFactory(e,i,n);return r.material=a,r.isVisible=!1,r.registerInstancedBuffer("color",4),r.instancedBuffers.color=new o.c(1,1,1,1),r}}]),e}();te.tileMesh=void 0,te.resourceMesh=void 0,te.unitMesh=[];var ie=function(){function e(t){Object(I.a)(this,e),this.game=t,this.scene=void 0,this.meshCache=void 0,this.listeners=void 0,this.elapsedSinceState=0,this.elapsedSinceUI=0,this.listeners=[],this.scene=void 0,this.meshCache=void 0}return Object(H.a)(e,[{key:"generate",value:function(e){var t=this;this.scene=e,this.meshCache=new te(this.scene),this.scene.ambientColor=new o.b(1,1,1);var i=new o.a("camera1",0,0,10,new o.j(0,6,16),this.scene);i.lowerBetaLimit=.1,i.upperBetaLimit=Math.PI/2*.8,i.lowerRadiusLimit=10,i.upperRadiusLimit=100,i.setTarget(o.j.Zero());var n=this.scene.getEngine().getRenderingCanvas();i.attachControl(n,!0);for(var a=[new o.e("light",new o.j(0,1,-2),this.scene),new o.e("light",new o.j(1,1,1),this.scene),new o.e("light",new o.j(-1,1,1),this.scene)],r=0;r<a.length;r++)a[r].intensity=.4;R(this.game,(function(e){return e.generate&&e.generate(t)})),this.game.startGame()}},{key:"ifElapsed",value:function(e,t,i,n){var a=e+t;return a>i?(n.call(this,a),0):a}},{key:"render",value:function(){var e=this;if(this.scene){var t=this.scene.getEngine().getDeltaTime(),i=Math.min(50,t)/1e3;this.elapsedSinceState=this.ifElapsed(this.elapsedSinceState,i,E.minDurationState,this.updateState),this.elapsedSinceUI=this.ifElapsed(this.elapsedSinceUI,i,E.minDurationUI,this.updateUI),R(this.game,(function(t){t.updateFrame&&t.updateFrame(e,i),t.draw&&t.draw(e)}))}}},{key:"updateState",value:function(e){var t=this;this.game.running()&&R(this.game,(function(i){return i.updateState&&i.updateState(t,e)}))}},{key:"updateUI",value:function(e){for(var t=0;t<this.listeners.length;t++)this.listeners[t]()}},{key:"addListener",value:function(e){this.listeners.push(e)}},{key:"removeListener",value:function(e){this.listeners=this.listeners.filter((function(t){return t!==e}))}},{key:"useListenerEffect",value:function(e){var t=this;return function(){return t.addListener(e),function(){return t.removeListener(e)}}}},{key:"generateUnit",value:function(e){e.viewObj=this.meshCache.makeUnitMesh(e)}},{key:"drawUnit",value:function(e){var t=e.viewObj;e.isAlive()||(t.instancedBuffers.color=e.owner.deadUnitColor),t.scaling.setAll(.5+.5*e.healthProportion()),t.position.copyFrom(e.position),t.rotation.y=e.rotY}},{key:"generateTile",value:function(e){e.viewObj=this.meshCache.makeTileMesh(e);for(var t=e.resMult,i=t<.75?3:2,n=(e.coords.x+i)%i,a=0;a<N.directions.length;a++)(t>1.5||t<.75&&a%3===n||t>=.75&&a%2===n)&&this.meshCache.makeResourceMesh(e,a)}},{key:"drawTile",value:function(e){e.viewObj.instancedBuffers.color=e.owner.tileColor(e.isHome,e.healthProportion())}},{key:"gameWinnerMessage",value:function(){return this.game.winner?"".concat(this.game.winner.name," wins!"):""}},{key:"getFPS",value:function(){return Math.round(this.scene.getEngine().getFps())}},{key:"getPlayerStatus",value:function(e){var t=this.game.players[e],i=Math.floor(t.resourceCount),n=w(this.game.board.tileList(),(function(e){return e.owner===t})),a=w(this.game.aliveUnits,(function(e){return e.owner===t}));return"".concat(t.name,": $").concat(i,", ").concat(n," tile(s), ").concat(a," unit(s)")}},{key:"getPlayerUPS",value:function(e){return this.game.players[e].ups}},{key:"setPlayerUPS",value:function(e,t){this.game.players[e].ups=t,this.updateUI(0)}}]),e}();function ne(e){return"FPS: ".concat(e.getFPS())}var ae={position:"absolute",top:0,right:0,opacity:.8,padding:"0.5em"};function re(e){return e.gameWinnerMessage()}var se={position:"absolute",top:"25vh",left:0,right:0,fontSize:"6em",textAlign:"center",textShadow:"#111 3px 3px"},oe={left:0,textAlign:"left",borderRight:"1px dashed forestgreen",borderTop:"1px dashed forestgreen"},he={right:0,textAlign:"right",borderLeft:"1px dashed red",borderTop:"1px dashed red"},ue=function(e){var t=e.game,i=Object(n.useMemo)((function(){return new ie(t)}),[t]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(X,{view:i,style:se,getMessage:re}),a.a.createElement(X,{view:i,style:ae,getMessage:ne}),a.a.createElement(W.a,{antialias:!0,onSceneReady:function(e){return i.generate(e)},onRender:function(){return i.render()},id:"game-canvas"}),a.a.createElement(ee,{view:i,playerIndex:1,style:oe}),a.a.createElement(ee,{view:i,playerIndex:2,style:he}))};i(49);var ce=function(){var e=Object(n.useMemo)((function(){return new q}),[]);return a.a.createElement("div",{className:"fullscreen"},a.a.createElement(ue,{game:e}))};s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(ce,null)),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.e29d06ab.chunk.js.map